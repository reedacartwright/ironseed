
<!-- README.md is generated from README.Rmd. Please edit that file -->

# Ironseed

<!-- badges: start -->

[![R-CMD-check](https://github.com/reedacartwright/ironseed/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/reedacartwright/ironseed/actions/workflows/R-CMD-check.yaml)
[![Codecov test
coverage](https://codecov.io/gh/reedacartwright/ironseed/graph/badge.svg)](https://app.codecov.io/gh/reedacartwright/ironseed)
<!-- badges: end -->

## Overview

Ironseed is an R package that improves seeding for R’s built in random
number generators. An ironseed is a finite-entropy (or fixed-entropy)
hash that can be used to generate an unlimited sequence of seeds for
initializing the state of a random number generator. It is inspired by
the work of M.E. O’Neill and others
\[[1](https://www.pcg-random.org/posts/simple-portable-cpp-seed-entropy.html),
[2](https://gist.github.com/imneme/540829265469e673d045)\].

An ironseed is a 256-bit hash constructed from a variable-length
sequence of 32-bit inputs. Each ironseed consists of eight 32-bit
sub-hashes. The sub-hashes are 32-bit multilinear hashes
\[[3](https://arxiv.org/pdf/1202.4961.pdf)\] that accumulate entropy
from the input sequence. Each input is included in every sub-hash. The
coefficients for the multilinear hashes are generated by a [Weyl
sequence](https://en.wikipedia.org/wiki/Weyl_sequence).

Multilinear hashes are also used to generate a seed sequence from an
ironseed. Each 32-bit output value is generated by uniquely hashing the
sub-hashes. The coefficients for the output are also generated by a
second Weyl sequence.

## Installation

You can install the development version of ironseed from
[GitHub](https://github.com/) with:

``` r
# install.packages("pak")
pak::pak("reedacartwright/ironseed")
```

## Examples: User Seeding

Ironseed can be used at the top of a script to robustly initialize R’s
builtin random number generator. The resulting ironseed is returned
invisibly, and a message is generated notifying the user that
initialization has occurred. This message can be logged and later used
to reproduce the run.

``` r
#!/usr/bin/env -S Rscript --vanilla
ironseed::ironseed("Experiment", 20251031, 1)
#> ** Ironseed : Seed RW7vjwjeiHF-QG7RYPvrntR-6tGPoi65sVc-N1n5SQi5RH4
runif(10)
#>  [1] 0.03158887 0.36714050 0.23088033 0.33215967 0.69246113 0.98602135
#>  [7] 0.44661582 0.75930377 0.77047433 0.90614352
```

If your script is intended to be called multiple times as part of a
large study, you can also seed based on the command line arguments.

``` r
#!/usr/bin/env -S Rscript --vanilla
args <- commandArgs(trailingOnly = TRUE)
ironseed::ironseed("A Simulation Script 1", args)
#> ** Ironseed : Seed Q9LKmfC2bf1-iCjg8C9QLaJ-k7JXxb5n5Vb-vpr9FbTxJa9
runif(10)
#>  [1] 0.16224205 0.24061448 0.04000381 0.50076538 0.95144747 0.23597125
#>  [7] 0.39933299 0.51114333 0.51120232 0.98538637
```

Specific command line arguments can also be used. For large, nested
studies, it is useful for scripts to support seeding using multiple
seeds. Ironseed makes this easy to accomplish.

``` r
#!/usr/bin/env -S Rscript --vanilla
args <- commandArgs(trailingOnly = TRUE)
ironseed::ironseed("A Simulation Script 2", args[grepl("--seed=", args)])
#> ** Ironseed : Seed xLD31yrUbqH-CUCsxN8xAUd-VprMDvpDEHE-To1fdD6houZ
runif(10)
#>  [1] 0.8275151 0.5527449 0.8364873 0.4608138 0.9786886 0.9014904 0.5726790
#>  [8] 0.6980262 0.3485765 0.3413197
```

## Examples: Automatic Seeding

Ironseed can also automatically initialize the random number generator
using an ironseed constructed from multiple sources of entropy. This
occurs if no data is passed to `ironseed()`.

``` r
#!/usr/bin/env -S Rscript --vanilla
ironseed::ironseed()
#> ** Ironseed : Seed vQCroxuohDS-8i3DkUfqgYQ-d9j6E7RsfsN-7bQzhjAueCM
runif(10)
#>  [1] 0.47795014 0.02721549 0.39524330 0.44262723 0.40121319 0.81276541
#>  [7] 0.57097420 0.73416579 0.41208366 0.55728840

# Since RNG initializing has occurred, the next call
# will simply return the ironseed used in seeding.
fe <- ironseed::ironseed()
fe
#> Ironseed: vQCroxuohDS-8i3DkUfqgYQ-d9j6E7RsfsN-7bQzhjAueCM
```

Or achieving the same thing with one call. Note that the automatically
generated seed is different from the previous run.

``` r
#!/usr/bin/env -S Rscript --vanilla
fe <- ironseed::ironseed()
#> ** Ironseed : Seed gKmhyjU4Y41-SEduBsV5GxX-DNAng7xtT2L-HeXBjUQif68
runif(10)
#>  [1] 0.14771730 0.28929581 0.32984660 0.76063549 0.85383069 0.01915642
#>  [7] 0.92973580 0.66183855 0.68517873 0.18682271
fe
#> Ironseed: gKmhyjU4Y41-SEduBsV5GxX-DNAng7xtT2L-HeXBjUQif68
```

## Examples: Reproducible Code

An ironseed can also be used directly to reproduce a previous
initialization. This is most useful when automatic seeding has been
used, and the previously generated seed has been logged.

``` r
#!/usr/bin/env -S Rscript --vanilla
ironseed::ironseed("RW7vjwjeiHF-QG7RYPvrntR-6tGPoi65sVc-N1n5SQi5RH4")
#> ** Ironseed : Seed RW7vjwjeiHF-QG7RYPvrntR-6tGPoi65sVc-N1n5SQi5RH4
runif(10)
#>  [1] 0.03158887 0.36714050 0.23088033 0.33215967 0.69246113 0.98602135
#>  [7] 0.44661582 0.75930377 0.77047433 0.90614352
```
