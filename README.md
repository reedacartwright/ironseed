
<!-- README.md is generated from README.Rmd. Please edit that file -->

# Ironseed

<!-- badges: start -->

[![R-CMD-check](https://github.com/reedacartwright/ironseed/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/reedacartwright/ironseed/actions/workflows/R-CMD-check.yaml)
[![Codecov test
coverage](https://codecov.io/gh/reedacartwright/ironseed/graph/badge.svg)](https://app.codecov.io/gh/reedacartwright/ironseed)
<!-- badges: end -->

## Overview

Ironseed is an R package that improves seeding for R’s built in random
number generators. An ironseed is a finite-entropy (or fixed-entropy)
hash that can be used to generate an unlimited sequence of seeds for
initializing the state of a random number generator. It is inspired by
the work of M.E. O’Neill and others
\[[1](https://www.pcg-random.org/posts/simple-portable-cpp-seed-entropy.html),
[2](https://gist.github.com/imneme/540829265469e673d045)\].

An ironseed is a 256-bit hash constructed from a variable-length
sequence of 32-bit inputs. Each ironseed consists of eight 32-bit
sub-hashes. The sub-hashes are 32-bit multilinear hashes
\[[3](https://arxiv.org/pdf/1202.4961.pdf)\] that accumulate entropy
from the input sequence. Each input is included in every sub-hash. The
coefficients for the multilinear hashes are generated by a [Weyl
sequence](https://en.wikipedia.org/wiki/Weyl_sequence).

Multilinear hashes are also used to generate a seed sequence from an
ironseed. Each 32-bit output value is generated by uniquely hashing the
sub-hashes. The coefficients for the output are also generated by a
second Weyl sequence.

## Installation

You can install the development version of ironseed from
[GitHub](https://github.com/) with:

``` r
# install.packages("pak")
pak::pak("reedacartwright/ironseed")
```

## Examples: User Seeding

Ironseed can be used at the top of a script to robustly initialize R’s
builtin random number generator. The resulting ironseed is returned
invisibly, and a message is generated notifying the user that
initialization has occurred. This message can be logged and later used
to reproduce the run.

``` r
#!/usr/bin/env -S Rscript --vanilla
ironseed::ironseed("Experiment", 20251031, 1)
#> ** Ironseed : Seed RW7vjwjeiHF-QG7RYPvrntR-6tGPoi65sVc-N1n5SQi5RH4
runif(10)
#>  [1] 0.03158887 0.36714050 0.23088033 0.33215967 0.69246113 0.98602135
#>  [7] 0.44661582 0.75930377 0.77047433 0.90614352
```

If your script is intended to be called multiple times as part of a
large study, you can also seed based on the command line arguments.

``` r
#!/usr/bin/env -S Rscript --vanilla
args <- commandArgs(trailingOnly = TRUE)
ironseed::ironseed("A Simulation Script 1", args)
#> ** Ironseed : Seed Q9LKmfC2bf1-iCjg8C9QLaJ-k7JXxb5n5Vb-vpr9FbTxJa9
runif(10)
#>  [1] 0.16224205 0.24061448 0.04000381 0.50076538 0.95144747 0.23597125
#>  [7] 0.39933299 0.51114333 0.51120232 0.98538637
```

Specific command line arguments can also be used. For large, nested
studies, it is useful for scripts to support seeding using multiple
seeds. Ironseed makes this easy to accomplish.

``` r
#!/usr/bin/env -S Rscript --vanilla
args <- commandArgs(trailingOnly = TRUE)
ironseed::ironseed("A Simulation Script 2", args[grepl("--seed=", args)])
#> ** Ironseed : Seed xLD31yrUbqH-CUCsxN8xAUd-VprMDvpDEHE-To1fdD6houZ
runif(10)
#>  [1] 0.8275151 0.5527449 0.8364873 0.4608138 0.9786886 0.9014904 0.5726790
#>  [8] 0.6980262 0.3485765 0.3413197
```

## Examples: Automatic Seeding

Ironseed can also automatically initialize the random number generator
using an ironseed constructed from multiple sources of entropy. This
occurs if no data is passed to `ironseed()`.

``` r
#!/usr/bin/env -S Rscript --vanilla
ironseed::ironseed()
#> ** Ironseed : Seed y536mcg57xb-VUu3qxWqSe3-RMSHXxunJAE-MEyWDxJkAgQ
runif(10)
#>  [1] 0.72359529 0.64615947 0.93509880 0.14422580 0.02305852 0.50508359
#>  [7] 0.95219053 0.82291140 0.82383709 0.61386743

# Since RNG initializing has occurred, the next call will simply
# return the ironseed used in previous seeding.
fe <- ironseed::ironseed()
fe
#> Ironseed: y536mcg57xb-VUu3qxWqSe3-RMSHXxunJAE-MEyWDxJkAgQ
```

Or achieving the same thing with one call. Note that the automatically
generated seed is different from the previous run.

``` r
#!/usr/bin/env -S Rscript --vanilla
fe <- ironseed::ironseed()
#> ** Ironseed : Seed ZjpmzFtrFdV-mKmQdQtSwu7-fYCrRKTE92V-s89V4UTppJ7
runif(10)
#>  [1] 0.84899617 0.06003381 0.51552124 0.90506294 0.54663063 0.77531334
#>  [7] 0.73463606 0.70044596 0.93788588 0.27377696
fe
#> Ironseed: ZjpmzFtrFdV-mKmQdQtSwu7-fYCrRKTE92V-s89V4UTppJ7
```

## Examples: Reproducible Code

An ironseed can also be used directly to reproduce a previous
initialization. This is most useful when automatic seeding has been
used, and the previously generated seed has been logged.

``` r
#!/usr/bin/env -S Rscript --vanilla
ironseed::ironseed("RW7vjwjeiHF-QG7RYPvrntR-6tGPoi65sVc-N1n5SQi5RH4")
#> ** Ironseed : Seed RW7vjwjeiHF-QG7RYPvrntR-6tGPoi65sVc-N1n5SQi5RH4
runif(10)
#>  [1] 0.03158887 0.36714050 0.23088033 0.33215967 0.69246113 0.98602135
#>  [7] 0.44661582 0.75930377 0.77047433 0.90614352
```
